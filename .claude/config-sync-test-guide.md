# 讯飞语义请求配置同步功能 - 测试指南

> 📅 创建时间：2025-11-13
> 🎯 目标：验证配置同步功能是否正常工作

---

## 🚀 快速测试指南

### 测试目标
验证在"讯飞语义请求"模块中切换应用ID后，"语义对比"模块中的讯飞语义请求能够自动使用相同的配置。

---

## 📋 测试步骤

### 步骤1：准备工作
1. ✅ 确保梧桐工具箱已启动
2. ✅ 打开浏览器开发者工具（F12）
3. ✅ 切换到"控制台（Console）"标签

### 步骤2：测试同步功能
1. **进入讯飞语义请求模块**
   - 点击左侧菜单中的"🗣️ 讯飞语义请求"

2. **找到转换服务配置**
   - 在页面左侧找到绿色背景的"转换服务配置"区域
   - 查看"应用ID选择"下拉框

3. **更改应用ID**
   - 从下拉框中选择一个不同的应用ID
   - **预期**：看到控制台输出 `[语义对比] 应用ID已更新: [新ID]`

4. **进入语义对比模块**
   - 点击左侧菜单中的"⚖️ 语义对比"

5. **建立连接**
   - 点击"连接"按钮
   - **预期**：看到"✅ 讯飞服务已连接，可进行对比查询"

6. **验证同步结果**
   - 进入"讯飞语义请求"模块
   - 查看当前选中的应用ID
   - 切换回"语义对比"模块
   - **预期**：两个模块中的应用ID应该相同

### 步骤3：验证实时同步
1. 在"讯飞语义请求"模块中再次更改应用ID
2. **预期**：看到控制台输出：
   ```
   [语义对比] 检测到应用ID变化，已同步: [新ID]
   [语义对比] 已重新初始化转换服务
   ```

### 步骤4：验证状态持久化
1. 在"讯飞语义请求"模块中选择一个特定的应用ID
2. 刷新页面（F5 或 Ctrl+R）
3. 分别进入两个模块
4. **预期**：两个模块都显示相同的应用ID

---

## ✅ 成功标准

### 必须通过的测试
- [ ] 在讯飞语义请求中更改应用ID后，控制台出现日志
- [ ] 切换到语义对比模块时，应用ID已同步
- [ ] 更改应用ID后，讯飞服务能正常连接
- [ ] 页面刷新后，配置保持一致
- [ ] 无需手动配置，两个模块自动同步

### 预期日志输出
```
[语义对比] 应用ID已更新: 9b3d4bz5foji1e5b6eebob4zskgj6q81
[语义对比] 从localStorage恢复应用ID: 9b3d4bz5foji1e5b6eebob4zskgj6q81
[语义对比] 检测到应用ID变化，已同步: [新ID]
[语义对比] 已重新初始化转换服务
```

---

## ❌ 常见问题

### 问题1：更改应用ID后没有日志输出
**原因**：可能代码未生效
**解决**：
1. 检查浏览器控制台是否有错误
2. 尝试刷新页面
3. 重新启动开发服务器

### 问题2：语义对比模块中的应用ID没有更新
**原因**：storage 事件监听器未生效
**解决**：
1. 确认在讯飞语义请求模块中更改了应用ID
2. 查看控制台是否有 `[语义对比]` 开头的日志
3. 如果没有日志，说明监听器未正常工作

### 问题3：连接讯飞服务失败
**原因**：应用ID无效或网络问题
**解决**：
1. 尝试在讯飞语义请求模块中先连接
2. 确保选择的应用ID有效
3. 检查网络连接

---

## 🔍 调试技巧

### 查看 localStorage
在浏览器控制台中执行：
```javascript
// 查看当前应用ID
localStorage.getItem('xunfei-convert-appId')

// 查看所有本地存储
localStorage
```

### 查看语义模块状态
在浏览器控制台中执行：
```javascript
// 获取语义对比模块状态
JSON.parse(localStorage.getItem('wutong-semantic-state-semantic-compare'))
```

### 监听 storage 事件
```javascript
// 手动触发 storage 事件
localStorage.setItem('xunfei-convert-appId', 'your-app-id-here')
```

---

## 📊 测试检查清单

| 测试项目 | 状态 | 备注 |
|---------|------|------|
| 讯飞语义请求模块可正常打开 | [ ] |  |
| 转换服务配置区域可见 | [ ] |  |
| 可以选择不同的应用ID | [ ] |  |
| 更改后控制台有日志输出 | [ ] |  |
| 语义对比模块应用ID已同步 | [ ] |  |
| 讯飞服务可正常连接 | [ ] |  |
| 页面刷新后配置保持 | [ ] |  |
| 切换模块时配置一致 | [ ] |  |

---

## 🎯 测试结果记录

请在测试过程中记录结果：

### 测试环境
- 操作系统：_____________
- 浏览器：_______________
- 应用版本：_____________

### 测试结果
```
✅ 通过测试 X 个
❌ 失败测试 Y 个
⚠️ 部分通过 Z 个
```

### 发现的问题
1. _________________________________
2. _________________________________
3. _________________________________

### 建议改进
1. _________________________________
2. _________________________________
3. _________________________________

---

## 📞 需要帮助？

如果测试过程中遇到问题：

1. **查看控制台日志**：所有同步操作都有详细日志
2. **检查 localStorage**：确认数据已正确保存
3. **刷新页面**：有时需要刷新才能看到效果
4. **查看文档**：参考 `.claude/xunfei-config-sync-feature.md`

---

## 🎉 测试完成

功能测试完成后，请：

1. 记录测试结果
2. 确认所有核心功能正常工作
3. 提交测试报告
4. 可以开始使用新功能！

---

*测试指南版本：v1.0*
*适用版本：梧桐工具箱 v1.0.0+*
*创建时间：2025-11-13*
